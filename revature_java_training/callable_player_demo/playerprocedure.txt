--sequence

   CREATE SEQUENCE  "JAVA"."PLAYER_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1020 CACHE 20 NOORDER  NOCYCLE ;
-- tables

  CREATE TABLE "JAVA"."TEAM" 
   (	"TID" NUMBER NOT NULL ENABLE, 
	"TNAME" VARCHAR2(20 BYTE) NOT NULL ENABLE, 
	 CONSTRAINT "TEAM_PK" PRIMARY KEY ("TID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;


  CREATE TABLE "JAVA"."PLAYER" 
   (	"ID" VARCHAR2(10 BYTE) NOT NULL ENABLE, 
	"NAME" VARCHAR2(20 BYTE) NOT NULL ENABLE, 
	"DOB" DATE NOT NULL ENABLE, 
	"CITY" VARCHAR2(20 BYTE) NOT NULL ENABLE, 
	"GENDER" VARCHAR2(1 BYTE) NOT NULL ENABLE, 
	"TID" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "PLAYER_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "PLAYER_FK1" FOREIGN KEY ("TID")
	  REFERENCES "JAVA"."TEAM" ("TID") ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;



CREATE OR REPLACE PROCEDURE REGISTERPLAYER 
(
  ID OUT VARCHAR2 
, NAME IN VARCHAR2 
, DOB IN DATE 
, CITY IN VARCHAR2 
, GENDER IN VARCHAR2 
, v_TNAME IN VARCHAR2 
) AS 
v_tid number;
BEGIN
 select 'PL'||Upper(substr(v_tname,0,2))||substr(EXTRACT(YEAR FROM (dob)),3)||player_seq.nextval into id 
 from dual;
 select tid into v_tid from team where tname=v_tname;
insert into player(id,name,dob,city,gender,tid) values(id,name,dob,city,gender,v_tid);
END REGISTERPLAYER;







-- for execution
DECLARE
  ID VARCHAR2(200);
  NAME VARCHAR2(200);
  DOB DATE;
  CITY VARCHAR2(200);
  GENDER VARCHAR2(200);
  V_TNAME VARCHAR2(200);
BEGIN
  NAME := 'girish';
  DOB := TO_DATE('2003/07/09', 'yyyy/mm/dd');
  CITY := 'bangalore';
  GENDER := 'M';
  V_TNAME := 'India';

  REGISTERPLAYER(
    ID => ID,
    NAME => NAME,
    DOB => DOB,
    CITY => CITY,
    GENDER => GENDER,
    V_TNAME => V_TNAME
  );
  /* Legacy output: 
DBMS_OUTPUT.PUT_LINE('ID = ' || ID);
*/ 
  :ID := ID;
--rollback; 
END;
